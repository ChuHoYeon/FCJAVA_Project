<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="user">
	<!-- 소속된 팀 개수 -->
	<select id="countTeam" resultType="java.lang.Integer">
	SELECT COUNT(*) FROM fc_java.pl_info WHERE id = #{id};
	</select>
	<!-- $팀 상세 -->
	<select id="selectTeam" resultType="com.fcjava.dto.TeamDTO">
	SELECT *
	FROM fc_java.team_info
	WHERE t_num = #{t_num};
	</select>
	<!-- $팀 상세 #가입한 선수목록 -->
	<select id="selectPlayerList" resultType="com.fcjava.dto.PlayerDTO">
	SELECT fc_java.pl_info.*,fc_java.mem_info.b_day,fc_java.mem_info.gender 
	FROM fc_java.pl_info JOIN fc_java.mem_info ON fc_java.pl_info.id = fc_java.mem_info.id 
	WHERE fc_java.pl_info.t_num = #{t_num};
	</select>
	<!-- $팀 상세 #팀 신청 -->
	<insert id="insertPlayerApply" parameterType="com.fcjava.dto.PlayerDTO">
	INSERT INTO fc_java.pl_info (t_num, id, pl_pic, back_num, position, pl_memo, height, weight)
	VALUES (#{t_num}, #{id}
	<choose>
		<when test="pl_pic != null">,#{pl_pic}</when>
		<otherwise>,null</otherwise>
	</choose>
	, #{back_num}, #{position}
	<choose>
		<when test="pl_memo != null">,#{pl_memo}</when>
		<otherwise>,null</otherwise>
	</choose>
	<choose>
		<when test="height != null">,#{height}</when>
		<otherwise>,null</otherwise>
	</choose><choose>
		<when test="weight != null">,#{weight}</when>
		<otherwise>,null</otherwise>
	</choose>
	);
	</insert>
	<!-- $팀 상세 #팀 탈퇴 -->
	<delete id="deleteTeamSecession" parameterType="com.fcjava.dto.PlayerDTO">
	DELETE FROM fc_java.pl_info
	WHERE t_num=#{t_num} and id=#{id};
	</delete>
	
	<!-- $대회 목록 #모든 리스트 -->
	<select id="allSelectGame" resultType="com.fcjava.dto.GameDTO">
		SELECT * 
		FROM fc_java.game 
		order by game_fn_date DESC;
	</select>
	<!-- $대회 목록  #검색 -->
	<select id="gameSelect" resultType="com.fcjava.dto.GameDTO">
		SELECT * 
		FROM fc_java.game 
		WHERE game_name LIKE '%${text}%'
		<if test="type != null and type.equals('ing')">
		AND game_subfn_date &lt; NOW() AND game_fn_date &gt; NOW()
		</if>
		<if test="type != null and type.equals('end')">
		AND game_fn_date &lt; NOW()
		</if>
		order by game_fn_date DESC;
	</select>
	
	<!-- $대회 상세 #대회정보 -->
	<select id="selectGame" resultType="com.fcjava.dto.GameDTO">
		SELECT * 
		FROM fc_java.game 
		WHERE game_num = ${game_num};
	</select>
	<!-- $대회 상세 #신청한 팀 리스트 -->
	<select id="selectApplyTeam" resultType="com.fcjava.dto.GameApplyTeam">
		SELECT game_apply.game_num, team_info.t_num, team_info.t_name, team_info.t_logo, game_apply.game_apply_date 
		FROM game_apply 
		JOIN team_info ON game_apply.team_num = team_info.t_num 
		WHERE game_apply.game_num = ${game_num};
	</select>
	<!-- $대회 상세 #신청 -->
	<insert id="applyGame" parameterType="com.fcjava.dto.GameApplyDTO">
		INSERT INTO fc_java.game_apply 
		VALUES(#{game_num},#{team_num},now(),default);
	</insert>
	<!-- $대회 상세 #신청 취소 -->
	<delete id="applyCancelGame" parameterType="com.fcjava.dto.GameApplyDTO">
		DELETE FROM fc_java.game_apply
		WHERE game_num=#{game_num} and team_num=#{team_num};
	</delete>
	<!-- $대회 상세 #대회 결과 -->
	<select id="getGameResult" resultType="com.fcjava.dto.GameResultDTO">
		SELECT *
		FROM fc_java.game_result
		WHERE game_num = #{gameNum};
	</select>
	
	<!-- $상품 리스트 -->
	<select id="prdSelect" resultType="com.fcjava.dto.PrdDTO">
		SELECT * FROM prdinfo;
	</select>
	<!-- #상품 등록 -->
	<insert id="insertPrd" parameterType="com.fcjava.dto.PrdDTO">
		insert into prdinfo values(${prd_no},#{prd_category},#{prd_name},#{prd_price},#{prd_image},#{prd_memo},#{prd_brand});
	</insert>
	<!-- #상품 삭제 -->
	<delete id="deletePrd" parameterType="com.fcjava.dto.PrdDTO">
		delete from testdb.user where prd_no = ${prd_no};
	</delete>
	
	<!-- 구장 등록-->
    <insert id="str_insert" parameterType="com.fcjava.dto.StadiumDTO">
        insert into fc_java.stadium1 (g_no, gmem_id, g_name, g_time, g_size, g_add, g_memo, g_img) values(#{g_no}, #{gmem_id}, #{g_name}, #{g_time}, #{g_size}, #{g_add}, #{g_memo}, #{g_img});
    </insert>
    <!-- 구장 리스트 -->
    <select id="sta_select" resultType="com.fcjava.dto.StadiumDTO">    
         SELECT * FROM fc_java.stadium1;
    </select>
    <!-- 구장 리스트 -->
    <select id="selectsta" resultType="com.fcjava.dto.StadiumDTO">
		SELECT * 
		FROM fc_java.stadium1 
		WHERE g_no = #{g_no};
	</select>
</mapper>